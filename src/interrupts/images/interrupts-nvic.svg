<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (c) 2025 implrust.com
License: Creative Commons Attribution 4.0 International (CC BY 4.0)
License URL: https://creativecommons.org/licenses/by/4.0/
-->
<svg viewBox="0 0 900 560" xmlns="http://www.w3.org/2000/svg">

  <rect width="900" height="560" fill="#111827"/>

  <!-- Title -->
  <text x="450" y="35" fill="#60a5fa" font-size="22" font-weight="bold" text-anchor="middle">
    Interrupts and NVIC
  </text>

  <!-- Peripherals -->
  <g fill="#312e81" stroke="#8b5cf6" stroke-width="2">
    <rect x="40" y="90" width="160" height="60" rx="6"/>
    <rect x="40" y="170" width="160" height="60" rx="6"/>
    <rect x="40" y="250" width="160" height="60" rx="6"/>
    <rect x="40" y="330" width="160" height="60" rx="6"/>
  </g>

  <g fill="#c4b5fd" font-size="13" text-anchor="middle">
    <text x="120" y="120">GPIO</text>
    <text x="120" y="140">Button Press</text>

    <text x="120" y="200">Timer</text>
    <text x="120" y="220">1ms Tick</text>

    <text x="120" y="280">ADC</text>
    <text x="120" y="300">Conversion Done</text>

    <text x="120" y="360">Other IRQ sources
</text>
    <text x="120" y="380">...</text>
  </g>

  <!-- NVIC -->
  <rect x="320" y="170" width="220" height="180" rx="8"
        fill="#1f2937" stroke="#f59e0b" stroke-width="3"/>
  <text x="430" y="200" fill="#fbbf24" font-size="16" font-weight="bold" text-anchor="middle">
    Interrupt Controller (NVIC)
  </text>

  <text x="430" y="235" fill="#fde68a" font-size="12" text-anchor="middle">
    Priority 0
  </text>
  <text x="430" y="255" fill="#fde68a" font-size="12" text-anchor="middle">
    Priority 1
  </text>
  <text x="430" y="275" fill="#fde68a" font-size="12" text-anchor="middle">
    Priority 2
  </text>

  <!-- CPU -->
  <rect x="620" y="170" width="220" height="180" rx="8"
        fill="#0f172a" stroke="#3b82f6" stroke-width="3"/>
  <text x="730" y="200" fill="#60a5fa" font-size="16" font-weight="bold" text-anchor="middle">
    CPU Core
  </text>

  <rect x="650" y="225" width="160" height="32" rx="4" fill="#1e293b"/>
  <text x="730" y="246" fill="#a5b4fc" font-size="12" text-anchor="middle">
    PC: current instruction
  </text>

  <rect x="650" y="265" width="160" height="32" rx="4" fill="#1e293b"/>
  <text x="730" y="286" fill="#a5b4fc" font-size="12" text-anchor="middle">
    CPU Registers
  </text>

  <!-- Stack -->
  <rect x="620" y="380" width="220" height="130" rx="8"
        fill="#022c22" stroke="#10b981" stroke-width="3"/>
  <text x="730" y="410" fill="#6ee7b7" font-size="16" font-weight="bold" text-anchor="middle">
    Stack Memory
  </text>

  <text x="730" y="440" fill="#d1fae5" font-size="12" text-anchor="middle">
    Saved PC
  </text>
  <text x="730" y="460" fill="#d1fae5" font-size="12" text-anchor="middle">
    Saved Registers
  </text>

  <!-- IRQ lines: Peripheral -> NVIC -->
  <g stroke="#ec4899" stroke-width="2" stroke-dasharray="5,5">
    <line x1="200" y1="120" x2="320" y2="220"/>
    <line x1="200" y1="200" x2="320" y2="240"/>
    <line x1="200" y1="280" x2="320" y2="260"/>
    <line x1="200" y1="360" x2="320" y2="280"/>
  </g>

  <!-- NVIC -> CPU -->
  <line x1="540" y1="260" x2="620" y2="260"
        stroke="#f59e0b" stroke-width="3"/>

  <!-- CPU -> Stack -->
  <line x1="730" y1="350" x2="730" y2="380"
        stroke="#10b981" stroke-width="2" stroke-dasharray="4,4"/>
</svg>
